# AITrade_MT5 - AI自动交易系统

⚠️ **重要警告：当前仓库只是测试可行性，千万不要在实际账户上进行操作！**

本项目仅用于学习和测试AI自动交易的可行性，请勿在真实交易环境中使用。任何实际交易造成的损失由用户自行承担。

## 项目概述

AITrade_MT5是一个基于Python的MetaTrader 5自动交易系统，通过AI分析市场数据并执行交易决策。系统每分钟自动分析市场并生成交易建议。

## 核心功能

### 1. MT5连接管理 (`MT5/`)
- **初始化模块** (`init.py`): 管理与MetaTrader 5终端的连接
- **市场信息** (`market_info.py`): 获取实时市场数据
- **订单信息** (`order_info.py`): 处理交易订单和持仓管理

### 2. AI分析引擎 (`AI/`)
- **AI客户端** (`client.py`): 连接到AI服务端，发送分析请求
- **交易分析** (`trading.py`): AI分析结果解析和交易执行逻辑
- **实时计算器** (`realtime_calculator.py`): 计算实时价格和技术指标
- **提示词管理** (`prompts.py`): 管理AI分析的系统提示词和用户提示词

### 3. 配置管理 (`config/`)
- **配置管理器** (`config_manager.py`): 加载和管理配置文件
- **日志配置** (`logging_config.py`): 设置系统日志记录

### 4. 工具模块 (`utils/`)
- **数据库** (`database.py`): 数据存储和历史记录管理
- **日志器** (`logger.py`): 应用程序和交易日志记录

## 系统工作流程

1. **初始化阶段**
   - 连接到MetaTrader 5终端
   - 加载配置文件（交易对、AI服务配置等）
   - 初始化日志系统

2. **主循环执行**（每分钟执行一次）
   - 获取最新的市场数据
   - 构建AI分析请求（包含技术指标、价格数据等）
   - 调用AI服务进行分析
   - 解析AI生成的交易建议
   - 执行交易操作（买入/卖出）
   - 记录交易结果和日志

3. **监控管理**
   - 实时监控持仓状态
   - 管理订单执行
   - 错误处理和重试机制

## 配置说明

### 主要配置项 (`config.yaml`)

- **交易配置**: 魔法数字、订单管理设置
- **监控货币对**: USDJPYm, USDCHFm, USDCADm, EURUSDm, AUDUSDm
- **AI服务**: API端点、密钥、模型配置
- **日志设置**: 日志目录和级别

### 关键特性

- ✅ **自动市场分析**: 每分钟自动分析多个货币对
- ✅ **AI驱动决策**: 基于GPT模型的智能交易建议
- ✅ **实时执行**: 自动执行AI生成的交易信号
- ✅ **风险管理**: 内置错误处理和重试机制
- ✅ **完整日志**: 详细记录所有交易和系统事件

## 安装和使用

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **配置设置**
   - 编辑 `config.yaml` 文件
   - 设置AI服务的API密钥和端点
   - 配置监控的货币对

3. **运行系统**
   ```bash
   python main.py
   ```

## 技术架构

- **编程语言**: Python 3.x
- **交易平台**: MetaTrader 5
- **AI服务**: OpenAI GPT API
- **数据格式**: YAML配置、JSON数据交换
- **日志系统**: Python logging模块

## 目录结构

```
AITrade_MT5_git/
├── main.py              # 主程序入口
├── config.yaml          # 配置文件
├── requirements.txt     # 依赖包列表
├── AI/                  # AI分析模块
├── MT5/                 # MetaTrader 5接口
├── config/              # 配置管理
├── utils/               # 工具模块
├── logs/                # 日志文件目录
└── data/                # 数据存储目录
```

## 注意事项

- 本系统仅用于教育和测试目的
- 使用前请充分了解外汇交易风险
- 建议先在模拟账户中测试
- 定期监控系统运行状态
- 及时更新配置和依赖包

## 已知缺陷和限制

### ⚠️ 重要：请仔细阅读以下已知问题

1. **剥头皮倾向问题**
   - 当前提示词中隐含剥头皮交易的倾向
   - 如需长期持仓策略需要大幅修改提示词设计
   - 由于改动工作量较大，目前保持现状

2. **市场延迟问题**
   - 外汇市场波动极其迅速，从获取市场数据到AI分析完成存在时间延迟
   - AI返回的交易建议可能已不适合当前市场环境
   - 这是自动化交易系统的普遍难题

3. **止损止盈计算不准确**
   - 为降低成本，采用AI返回模型+本地计算止损止盈值的方案
   - 本地计算的精确度有限，可能影响风险管理效果
   - 暂时没有更好的解决方案

4. **数据传输限制**
   - 出于成本考虑，未将所有报价信息发送给AI
   - 仅发送本地计算的关键技术指标（见 `prompts.py` 和 `market_info.py`）
   - 可能影响AI分析的全面性和准确性

### 📊 相关文件说明

- **`AI/prompts.py`**: 查看发送给AI的具体数据格式和内容
- **`MT5/market_info.py`**: 了解本地计算了哪些技术指标发送给AI

### 🚨 最后警告

**看看AI操作就好，千万别在实仓运行！** 

连虚拟仓的操作都可能让你气炸，实仓的后果可想而知。本系统仅用于学习AI在金融领域的应用逻辑，切勿作为实际交易工具使用！

---

**免责声明**: 本项目仅供学习和研究使用，不构成投资建议。使用本系统进行实际交易的任何损失由用户自行承担。